datatype Atoms = TEST

let fun spawned_func dialer = 
        send(dialer, TEST)

    val pid = self ()
    val receiver = spawn("@test-listener", fn () => spawned_func pid)

in receive [hn x => printString "bug"]
end